<div class="main-container">
    <div class="master-heading bcspace">
        <div class="back-btn">
            <a mat-button (click)="db.goBack()"><i class="material-icons">arrow_right_alt</i></a>
        </div>
        <div class="vl-info">
            <ul>
                <!-- <li class="af-none"><p><span class="blue"> {{vendor.company_name}}</span> <i class="material-icons r-arrow">keyboard_arrow_right</i>  </p></li> -->
                <li class="af-none"><p><span class="blue">{{vendor.company_name}}</span></p></li>
            </ul>
        </div>
    </div>
    <div class="cs-container detail">
        <div class="cs-spinner full-page" *ngIf = "!loading_list">
            <div class="outer">
                <div class="innear">
                    <mat-spinner></mat-spinner>
                    <P>LOADING . . .</P>
                </div>
            </div>
        </div>
        <form name="form" (ngSubmit)="f.form.valid && updateVendor()" #f="ngForm" novalidate >
            <div class="row">
                <div class="col-8">
                    <div class="right-data pl0 ">
                        <div class="contst">
                            <div class="cs-heading">
                                <h2>Vendor Detail</h2>
                                <p><i class="material-icons ic-watch">watch_later</i>{{vendor.created_at  | date: 'dd MMM yyyy'}} </p>
                            </div>                      
                            <div class="cs-divider pt10">
                                <mat-divider></mat-divider>
                            </div>                      
                            <div class="form-field">
                                <div class="row">
                                    <div class="row">
                                        <div class="col-7">
                                            <div class="row">
                                                <div class="control-field col-6 edit-input"  [ngClass]="{'active': enable_company_name}" >
                                                    <mat-form-field class="example-full-width cs-input">
                                                        <input matInput placeholder="Company Name" readonly={{!enable_company_name}} name="company_name" [(ngModel)]="form.company_name" #company_name="ngModel">
                                                        <div class="edit-icon">
                                                            <button mat-button class="save" *ngIf="enable_company_name"><i class="material-icons green-text" title="Save">save</i></button>
                                                            <a mat-button class="edit" *ngIf="!enable_company_name" (click)="enable_company_name = true"><i class="material-icons blue-text" title="EDIT">create</i></a>
                                                        </div>
                                                    </mat-form-field>                                      
                                                </div> 
                                                <div class="control-field col-6 edit-input"  [ngClass]="{'active': enable_email}" >
                                                    <mat-form-field class="example-full-width cs-input">
                                                        <input matInput readonly={{!enable_email}} name="email" [(ngModel)]="form.email" #email="ngModel"   placeholder="Email"   pattern="[a-zA-Z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*" >
                                                        <div class="edit-icon">
                                                            <button mat-button class="save" *ngIf="enable_email" class="save"><i class="material-icons green-text" title="EDIT">save</i></button>
                                                            <a mat-button class="edit" *ngIf="!enable_email" (click)="enable_email = true"><i class="material-icons blue-text" title="EDIT">create</i></a>
                                                        </div>
                                                    </mat-form-field>
                                                </div>
                                                <div class="control-field col-6 edit-input"  [ngClass]="{'active': enable_contact}">
                                                    <mat-form-field class="example-full-width cs-input" >
                                                        <input matInput readonly={{!enable_contact}}  (keypress)="numeric_Number($event)" name="mobile" [(ngModel)]="form.mobile" #mobile="ngModel" placeholder="Mobile Number" maxlength="10" minlength="10"  >
                                                        <div class="edit-icon">
                                                            <button mat-button class="save" *ngIf="enable_contact" ><i class="material-icons green-text" title="Save">save</i></button>
                                                            <a mat-button class="edit" *ngIf="!enable_contact" (click)="enable_contact = true" ><i class="material-icons blue-text" title="EDIT">create</i></a>
                                                        </div>
                                                    </mat-form-field>
                                                </div>
                                                
                                                <div class="control-field col-6 edit-input"  [ngClass]="{'active': enable_meterial_type}" >
                                                    <mat-form-field class="example-full-width cs-input">
                                                        <input matInput placeholder="Material Type" readonly={{!enable_meterial_type}} name="meterial_type" [(ngModel)]="form.meterial_type" #meterial_type="ngModel">
                                                        <div class="edit-icon">
                                                            <button mat-button class="save" *ngIf="enable_meterial_type"><i class="material-icons green-text" title="Save">save</i></button>
                                                            <a mat-button class="edit" *ngIf="!enable_meterial_type" (click)="enable_meterial_type = true"><i class="material-icons blue-text" title="EDIT">create</i></a>
                                                        </div>
                                                    </mat-form-field>                                      
                                                </div> 
                                                
                                                
                                            </div>  
                                        </div>
                                        
                                        <div class="control-field col-5 edit-input addrs-input pr6" [ngClass]="{'active': enable_address}">
                                            <mat-form-field class="example-full-width cs-input"  >
                                                <textarea matInput placeholder="ADDRESS" readonly={{!enable_address}} name="address" [(ngModel)]="form.address" #address="ngModel" class="h120"  ></textarea>
                                                <div class="edit-icon">
                                                    <button mat-button class="save" *ngIf="enable_address"><i class="material-icons green-text" title="Save">save</i></button>
                                                    <a mat-button class="edit" *ngIf="!enable_address" (click)="enable_address = true"><i class="material-icons blue-text" title="EDIT">create</i></a>
                                                </div>
                                            </mat-form-field>
                                        </div>                                        
                                        
                                       

                                        <div class="control-field col-4 edit-input"  [ngClass]="{'active': enable_gst_no}" >
                                            <mat-form-field class="example-full-width cs-input">
                                                <input matInput placeholder="GST No." readonly={{!enable_gst_no}} name="gst_no" [(ngModel)]="form.gst_no" #gst_no="ngModel">
                                                <div class="edit-icon">
                                                    <button mat-button class="save" *ngIf="enable_gst_no"><i class="material-icons green-text" title="Save">save</i></button>
                                                    <a mat-button class="edit" *ngIf="!enable_gst_no" (click)="enable_gst_no = true"><i class="material-icons blue-text" title="EDIT">create</i></a>
                                                </div>
                                            </mat-form-field>                                      
                                        </div> 

                                        <div class="control-field col-4 edit-input"  [ngClass]="{'active': enable_hsn_code}" >
                                            <mat-form-field class="example-full-width cs-input">
                                                <input matInput placeholder="HSN Code" readonly={{!enable_hsn_code}} name="hsn_code" [(ngModel)]="form.hsn_code" #hsn_code="ngModel">
                                                <div class="edit-icon">
                                                    <button mat-button class="save" *ngIf="enable_hsn_code"><i class="material-icons green-text" title="Save">save</i></button>
                                                    <a mat-button class="edit" *ngIf="!enable_hsn_code" (click)="enable_hsn_code = true"><i class="material-icons blue-text" title="EDIT">create</i></a>
                                                </div>
                                            </mat-form-field>                                      
                                        </div> 

                                        <div class="control-field col-4 ">
                                            <mat-form-field class="example-full-width cs-input">
                                                <input matInput placeholder="Country" readonly="" [value]="countries.name" name="country_id" [(ngModel)]="form.country_id" #country_id="ngModel">
                                            </mat-form-field>
                                        </div>
                                        
                                        
  
                                        
                                        <div class="control-field col-4 edit-input"  [ngClass]="{'active': enable_state}">
                                            <mat-form-field class="cs-multi-select cs-input" >
                                                <mat-select placeholder="State" [disabled]="!enable_state" name="state" (selectionChange)="getDistrictList()" [(ngModel)] = "form.state" #state="ngModel" required>
                                                    <mat-option *ngFor = "let val of states" [value]="val.state_name"> {{val.state_name}} </mat-option>                                              
                                                </mat-select>
                                                
                                                <div class="edit-icon right-side" [ngClass]="{'active': enable_state}">
                                                    <button mat-button class="save dark-green-bg  " *ngIf="enable_state" type="submit"><i class="material-icons" title="Save">save</i></button>
                                                    <a mat-button class="edit" *ngIf="!enable_state" (click)="enable_state=true"><i class="material-icons blue-text" title="EDIT">create</i></a>
                                                </div>
                                            </mat-form-field>
                                            
                                        </div>
 
                                        
                                        <div class="control-field col-4 edit-input" [ngClass]="{'active': enable_district}">
                                            <mat-form-field class="cs-multi-select cs-input" >
                                                <mat-select placeholder="District" [disabled]="!enable_district" name="district" (selectionChange)="getCityList()" [(ngModel)] = "form.district" #district="ngModel" required>
                                                    <mat-option *ngFor="let val of districts" [value]="val.district_name"> {{val.district_name}} </mat-option>                                             
                                                </mat-select>
                                                
                                                <div class="edit-icon right-side" [ngClass]="{'active': enable_district}">
                                                    <button mat-button class="save dark-green-bg  " *ngIf="enable_district" type="submit"><i class="material-icons" title="Save">save</i></button>
                                                    <a mat-button class="edit" *ngIf="!enable_district" (click)="enable_district=true"><i class="material-icons blue-text" title="EDIT">create</i></a>
                                                </div>
                                            </mat-form-field>
                                        </div>
                                        
                                        <div class="control-field col-4 edit-input" [ngClass]="{'active': enable_city}" > 
                                            <mat-form-field class="example-full-width cs-input" >
                                                <input matInput placeholder="City" readonly={{!enable_city}} name="city" [(ngModel)]="form.city" #city="ngModel" >                                        
                                                <div class="edit-icon">
                                                    <button mat-button class="save" *ngIf="enable_city"><i class="material-icons green-text" title="Save">save</i></button>
                                                    <a mat-button class="edit" *ngIf="!enable_city" (click)="enable_city = true"><i class="material-icons blue-text" title="EDIT">create</i></a>
                                                </div>
                                            </mat-form-field>                    
                                        </div>
                                        
                                        
                                        
                              
                                        <div class="control-field col-4 edit-input" [ngClass]="{'active': enable_pin_code}">
                                            <mat-form-field class="cs-multi-select cs-input" >
                                                <mat-select placeholder="Pin-Code" [disabled]="!enable_pin_code" name="pin" [(ngModel)] = "form.pin" #pin="ngModel" required>
                                                    <mat-option *ngFor="let val of pincodes" [value]="val.pincode"> {{val.pincode}} </mat-option>                                           
                                                </mat-select>
                                                
                                                <div class="edit-icon" [ngClass]="{'active': enable_pin_code}">
                                                    <button mat-button class="save dark-green-bg  " *ngIf="enable_pin_code" type="submit"><i class="material-icons" title="Save">save</i></button>
                                                    <a mat-button class="edit" *ngIf="!enable_pin_code" (click)="enable_pin_code=true"><i class="material-icons blue-text" title="EDIT">create</i></a>
                                                </div>
                                            </mat-form-field>
                                        </div>

                                        <div class="control-field col-4 edit-input"  [ngClass]="{'active': enable_gst_percentage}" >
                                                <mat-form-field class="example-full-width cs-input">
                                                    <input matInput placeholder="GST Percentage" readonly={{!enable_gst_percentage}} name="gst_percentage" [(ngModel)]="form.gst_percentage" #gst_percentage="ngModel">
                                                    <div class="edit-icon">
                                                        <button mat-button class="save" *ngIf="enable_gst_percentage"><i class="material-icons green-text" title="Save">save</i></button>
                                                        <a mat-button class="edit" *ngIf="!enable_gst_percentage" (click)="enable_gst_percentage = true"><i class="material-icons blue-text" title="EDIT">create</i></a>
                                                    </div>
                                                </mat-form-field>                                      
                                            </div> 
                                        
                                        
                                        
                                    </div>
                                </div>
                                
                                
                                
                                <div class="cs-heading mt20">
                                    <h2 class="underline">CONTACT PERSON DETAILS </h2>
                                </div>
                                <div class="row" *ngFor="let contactt of vendor_con; let x = index" >
                                    <div class="control-field col-6 edit-input" [ngClass]="{'has-error': !contactt.name, 'active' : active[x]?.c_person == '1' }">
                                        <mat-form-field class="example-full-width cs-input" >
                                            <input matInput (keyup.enter)="update_vendor_contact(x)" [name]="'contact_person'+x"  [readonly]="!active[x]?.c_person" [(ngModel)]="contactt.name">
                                            <div class="edit-icon">
                                                <button mat-button class="save" *ngIf="active[x]?.c_person" ><i (click)="update_vendor_contact(x)" class="material-icons green-text" title="Save">save</i></button>
                                                <a mat-button class="edit"  *ngIf="!active[x]?.c_person"><i (click)="edit_cp(x)" class="material-icons blue-text" title="EDIT">create</i></a>
                                            </div>
                                        </mat-form-field>
                                    </div>                              
                                    <div class="control-field col-6 edit-input" [ngClass]="{ 'active' : active[x]?.c_mobile1 == '1','has-error': !contactt.phone1 }">
                                        <mat-form-field class="example-full-width cs-input" >
                                            <input matInput  (keypress)="numeric_Number($event)" (keyup.enter)="update_vendor_contact(x)" [name]="'contact_mobile1'+x"  [readonly]="!active[x]?.c_mobile1" maxlength="10" [(ngModel)]="contactt.phone1">
                                            <div class="edit-icon">
                                                <button mat-button class="save" *ngIf="active[x]?.c_mobile1"><i (click)="update_vendor_contact(x)" class="material-icons green-text" title="Save">save</i></button>
                                                <a mat-button class="edit"  *ngIf="!active[x]?.c_mobile1"><i (click)="edit_mobile_1(x)" class="material-icons blue-text" title="EDIT">create</i></a>
                                            </div>
                                        </mat-form-field>
                                    </div>                              
                                    <!-- <div class="control-field col-4  edit-input"  [ngClass]="{'has-error': !contactt.phone2, 'active' : active[x]?.c_mobile2 == '1'}">
                                        <mat-form-field class="example-full-width cs-input" >
                                            <input matInput  (keypress)="numeric_Number($event)" (keyup.enter)="update_vendor_contact(x)" [name]="'contact_mobile2'+x"  [readonly]="!active[x]?.c_mobile2" maxlength="10" [(ngModel)]="contactt.phone2">
                                            <div class="edit-icon">
                                                <button mat-button class="save" *ngIf="active[x]?.c_mobile2"><i (click)="update_vendor_contact(x)" class="material-icons green-text" title="Save">save</i></button>
                                                <a mat-button class="edit" *ngIf="!active[x]?.c_mobile2"><i (click)="edit_mobile_2(x)" class="material-icons blue-text" title="EDIT">create</i></a>
                                            </div>
                                        </mat-form-field>
                                    </div>                               -->
                                </div>
                                
                                
                                
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-4">
                    <div class="right-data sticky">
                        <div class="contst left-calls-info">
                            <div class="cs-heading">
                                <h2 (click)="currentdeals()">DEALING WITH</h2>
                                <p><a mat-raised-button color="warn" (click)="remainingdeals()" class="font13" style="margin-top: -10px; color: #fff;" *ngIf="vendor_redeal.length" >Add New Product</a></p>
                                <input  *ngIf="current_deal" type="text" placeholder="search..."  (input)="getPartCheckin('mode1',search2.search3)" #search3="ngModel" name='search3' [(ngModel)]="search2.search3">
                            </div>                      
                            <div class="row" *ngIf="current_deal">
                                <div class="col-12 plan-list step1 shadow-none" style="background: transparent;">
                                    <div class="listing">  
                                        <ul class="checkbox-list pr15">
                                            <li class="pt15" *ngFor="let deals of vendor_deal; let y = index">
                                                <label>
                                                    <div class="txt-box">
                                                        <p>
                                                            <span class="cs-head">Equipment Id</span>
                                                            {{deals.part_number}}
                                                        </p>  
                                                        <p>
                                                            <span class="cs-head">Size</span>
                                                            {{deals.dimensions}}
                                                        </p>
                                                        <p>
                                                            <span class="cs-head">Price</span>
                                                            {{deals.purchase_price}}
                                                        </p>
                                                    </div>
                                                    <a mat-button class="font12 remove"  (click)="update_vendor_deal_remove(deals.id)">
                                                        <i class="material-icons">delete_sweep</i>
                                                    </a> 
                                                </label>
                                            </li>                                                    
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Add product Data -->
                            <div class="row" *ngIf="remaining_deal">
                                <input type="text" placeholder="search..."  (input)="getPartCheckin('mode2',search2.search1)" #search1="ngModel" name='search1' [(ngModel)]="search2.search1">
                                <div class="col-12 plan-list step1 shadow-none" style="background: transparent;">
                                    <div class="listing">  
                                        <ul class="checkbox-list pr15">
                                            <li class="pt15" *ngFor="let productss of vendor_redeal; let  z=index" >
                                                <label>
                                                    <div class="txt-box">
                                                        <p>
                                                            <span class="cs-head">Equipment Id</span>
                                                            {{productss.part_number}}
                                                        </p>  
                                                        <p>
                                                            <span class="cs-head">Size</span>
                                                            {{productss.dimensions}}
                                                        </p>
                                                        <p>
                                                            <span class="cs-head">Price</span>
                                                            {{productss.purchase_price}}
                                                        </p>
                                                    </div>
                                                    <mat-checkbox class="cs-check" value={{productss.pro_id}} (change)="update_vendor_deal_add(productss.id,productss.part_number)"
                                                    name = "deal_pro_id"
                                                    style="width:5%;display: inline-block;"></mat-checkbox>
                                                </label>
                                            </li>                                                    
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="row">                
                <div class="cs-table-tabs">
                    <ul>
                        
                        <li>
                            <a (click)="GetPurchaseOrder('Pending')" [ngClass]="{'active': enable_pending_po}">
                                <p>PENDING</p>
                                <span class="counter yellow-bg">{{purchase_pending_count}}</span>
                            </a>
                        </li>
                        <li>
                            <a (click)="GetPurchaseOrder('Received')" [ngClass]="{'active': enable_receive_po}">
                                <p>RECEIVED</p>
                                <span class="counter green-bg">{{purchase_receive_count}}</span>
                            </a>
                        </li>
                        <li>
                            <a (click)="GetPurchaseOrder('Rejected')" [ngClass]="{'active': enable_cancel_po}">
                                <p>CANCEL</p>
                                <span class="counter red-bg">{{purchase_reject_count}}</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="cs-table left-right-15">
                    <div class="header">
                        <table class="sno-border">
                            <tr>
                                <th class="w30 border-right-none"></th>
                                <th class="w150">Date</th>
                                <th class="w150">Created By </th>
                                <th class="w150">PO - ID.</th>
                                <th class="padding0">
                                    <table>
                                        <tr>
                                            <th class="w120">Part Number</th>
                                            <th class="w80 text-center">QTY</th>
                                            <th class="w80 text-center">Rate</th>
                                            <th class="w80 text-center">Item Total</th>
                                        </tr>
                                    </table>
                                </th>
                                <th class="w130">Item QTY</th>
                                <th class="w170">Value</th>
                            </tr>
                        </table>
                    </div>
                    <div class="table-container">
                        <div class="table-body">
                            <table class="sno-border">
                                
                                <tr *ngFor="let purchases of vendor_purchase; let yy = index">
                                    <td class="w30 text-center">{{yy+1}}</td>
                                    <td class="w150">{{purchases.date_created | date: 'dd MMM yyyy'}}</td>
                                    <td class="w150">                                            
                                        <table>  
                                            <ng-container *ngFor="let usnam1 of usernam">                                            
                                                <ng-container *ngIf="usnam1.user_id == purchases.created_by">
                                                    <tr><td>{{ usnam1.username }} </td></tr>
                                                </ng-container>
                                            </ng-container>                                                
                                        </table>
                                    </td>
                                    <td class="w150"><a  mat-button class="link" routerLink="/purchases/{{purchases.id}}/details/" routerLinkActive="active">{{purchases.invoice_id}}</a></td>
                                    <td class="in-table">            
                                        <table>  
                                            <ng-container *ngFor="let itmname of itemnam">                                            
                                                <ng-container *ngIf="itmname.purchase_order_id == purchases.id">
                                                    <tr>
                                                        <td class="w120">{{ itmname.part_number }}</td>
                                                        <td class="w80 text-center">{{ itmname.qty }}</td>
                                                        <td class="w80 text-center">{{ itmname.rate }}</td>
                                                        <td class="w80 text-center">{{ itmname.item_total }} </td>
                                                    </tr>
                                                </ng-container>
                                            </ng-container>                                                
                                        </table></td>
                                        <td class="w130">{{purchases.total_items}}</td>
                                        <td class="w170">&#8377; {{purchases.order_total}}
                                            
                                        </td>
                                    </tr>                          
                                </table>
                            </div>
                        </div>
                    </div>     
                </div>
            </form> 
        </div>        
    </div>    
    <div class="h100"></div>